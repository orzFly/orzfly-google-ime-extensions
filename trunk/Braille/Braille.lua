-- encoding: UTF-8

------------------------------------------------
-- 谷歌拼音布莱叶盲文输入扩展
-- 版本: 0.1.0.1
-- 作者: Yichen Lu
-- 作者主页: http://orzfly.com/
-- 扩展主页: http://orztech.com/google-pinyin-ime-extension/braille-input
-- 项目主页: http://code.google.com/p/google-pinyin-api/
-- 问题反馈: http://orztech.com/forms/2
--
-- 此扩展遵循GPLv3发布
------------------------------------------------
-- orderedPairs: http://lua-users.org/wiki/SortedIteration
_0=pairs function _1(_6)local _2={}for _4 in _0(_6)do table.insert(_2,_4)end table.sort(_2)return _2 end function _3(_6,_5)if _5==nil then _6._7=_1(_6)_4=_6._7[1]return _4,_6[_4]end _4=nil for _8 = 1,table.getn(_6._7)do if _6._7[_8]==_5 then _4=_6._7[_8+1]end end if _4 then return _4,_6[_4]end _6._7=nil return end function _9(_6)return _3,_6,nil end pairs=_9

function YichenLu_Braille(arg)
  local input = string.lower(arg)
  local pos = string.find(input, "#")
  local inputn = nil
  local metatables = nil
  if (not (pos==nil)) then
    inputn = tonumber(string.sub(input,pos+1))
    if inputn == nil then
      metatables = {}
      for k, v in pairs(_YichenLu_Braille_Code) do
        table.insert(metatables, {["suggest"] = k, ["help"] = v[3], ["id"] = k})
      end
    elseif _YichenLu_Braille_Code[inputn] then
      metatables = {_YichenLu_Braille_Code[inputn][3], _YichenLu_Braille_Code[inputn][1], "#"..inputn}
    end
  elseif #arg == 0 then
    metatables = {}
    for k, v in pairs(_YichenLu_Braille_Code) do
       table.insert(metatables, {["suggest"] = v[2], ["help"] = v[3], ["id"] = k})
    end
  elseif not (tonumber(input) == nil) then
    metatables = {}
    for k, v in pairs(_YichenLu_Braille_Code) do
      if string.sub(v[2], 1, #input) == input then
        table.insert(metatables, {["suggest"] = string.sub(v[2], #input+1), ["help"] = v[3], ["id"] = k})
      end
    end
  else
    metatables = {}
    local flag=nil
    for k, v in pairs(_YichenLu_Braille_Code) do
      if string.sub(v[1], 1, #input) == input then
        table.insert(metatables, {["suggest"] = string.sub(v[1], #input+1), ["help"] = v[3], ["id"] = k})
      end
      if v[2]==input then flag={["suggest"] = string.sub(v[1], #input+1), ["help"] = v[3], ["id"] = k} end
    end
    if not (flag==nil) then metatables={flag} end
  end
  if (type(metatables)=="table") and (#metatables == 1) then
    return YichenLu_Braille("#"..metatables[1]["id"])
  elseif ((type(metatables)=="table") and (#metatables == 0)) or (metatables==nil) then
    return "-- 找不到您输入的盲文字符 --"
  end
  return metatables
end

_YichenLu_Braille_Code ={
[0]={"ssss","00000000","⠀"},
[1]={"ssse","00000001","⢀"},
[2]={"sssq","00000010","⡀"},
[3]={"sssw","00000011","⣀"},
[4]={"sses","00000100","⠠"},
[5]={"ssee","00000101","⢠"},
[6]={"sseq","00000110","⡠"},
[7]={"ssew","00000111","⣠"},
[8]={"ssqs","00001000","⠄"},
[9]={"ssqe","00001001","⢄"},
[10]={"ssqq","00001010","⡄"},
[11]={"ssqw","00001011","⣄"},
[12]={"ssws","00001100","⠤"},
[13]={"sswe","00001101","⢤"},
[14]={"sswq","00001110","⡤"},
[15]={"ssww","00001111","⣤"},
[16]={"sess","00010000","⠐"},
[17]={"sese","00010001","⢐"},
[18]={"sesq","00010010","⡐"},
[19]={"sesw","00010011","⣐"},
[20]={"sees","00010100","⠰"},
[21]={"seee","00010101","⢰"},
[22]={"seeq","00010110","⡰"},
[23]={"seew","00010111","⣰"},
[24]={"seqs","00011000","⠔"},
[25]={"seqe","00011001","⢔"},
[26]={"seqq","00011010","⡔"},
[27]={"seqw","00011011","⣔"},
[28]={"sews","00011100","⠴"},
[29]={"sewe","00011101","⢴"},
[30]={"sewq","00011110","⡴"},
[31]={"seww","00011111","⣴"},
[32]={"sqss","00100000","⠂"},
[33]={"sqse","00100001","⢂"},
[34]={"sqsq","00100010","⡂"},
[35]={"sqsw","00100011","⣂"},
[36]={"sqes","00100100","⠢"},
[37]={"sqee","00100101","⢢"},
[38]={"sqeq","00100110","⡢"},
[39]={"sqew","00100111","⣢"},
[40]={"sqqs","00101000","⠆"},
[41]={"sqqe","00101001","⢆"},
[42]={"sqqq","00101010","⡆"},
[43]={"sqqw","00101011","⣆"},
[44]={"sqws","00101100","⠦"},
[45]={"sqwe","00101101","⢦"},
[46]={"sqwq","00101110","⡦"},
[47]={"sqww","00101111","⣦"},
[48]={"swss","00110000","⠒"},
[49]={"swse","00110001","⢒"},
[50]={"swsq","00110010","⡒"},
[51]={"swsw","00110011","⣒"},
[52]={"swes","00110100","⠲"},
[53]={"swee","00110101","⢲"},
[54]={"sweq","00110110","⡲"},
[55]={"swew","00110111","⣲"},
[56]={"swqs","00111000","⠖"},
[57]={"swqe","00111001","⢖"},
[58]={"swqq","00111010","⡖"},
[59]={"swqw","00111011","⣖"},
[60]={"swws","00111100","⠶"},
[61]={"swwe","00111101","⢶"},
[62]={"swwq","00111110","⡶"},
[63]={"swww","00111111","⣶"},
[64]={"esss","01000000","⠈"},
[65]={"esse","01000001","⢈"},
[66]={"essq","01000010","⡈"},
[67]={"essw","01000011","⣈"},
[68]={"eses","01000100","⠨"},
[69]={"esee","01000101","⢨"},
[70]={"eseq","01000110","⡨"},
[71]={"esew","01000111","⣨"},
[72]={"esqs","01001000","⠌"},
[73]={"esqe","01001001","⢌"},
[74]={"esqq","01001010","⡌"},
[75]={"esqw","01001011","⣌"},
[76]={"esws","01001100","⠬"},
[77]={"eswe","01001101","⢬"},
[78]={"eswq","01001110","⡬"},
[79]={"esww","01001111","⣬"},
[80]={"eess","01010000","⠘"},
[81]={"eese","01010001","⢘"},
[82]={"eesq","01010010","⡘"},
[83]={"eesw","01010011","⣘"},
[84]={"eees","01010100","⠸"},
[85]={"eeee","01010101","⢸"},
[86]={"eeeq","01010110","⡸"},
[87]={"eeew","01010111","⣸"},
[88]={"eeqs","01011000","⠜"},
[89]={"eeqe","01011001","⢜"},
[90]={"eeqq","01011010","⡜"},
[91]={"eeqw","01011011","⣜"},
[92]={"eews","01011100","⠼"},
[93]={"eewe","01011101","⢼"},
[94]={"eewq","01011110","⡼"},
[95]={"eeww","01011111","⣼"},
[96]={"eqss","01100000","⠊"},
[97]={"eqse","01100001","⢊"},
[98]={"eqsq","01100010","⡊"},
[99]={"eqsw","01100011","⣊"},
[100]={"eqes","01100100","⠪"},
[101]={"eqee","01100101","⢪"},
[102]={"eqeq","01100110","⡪"},
[103]={"eqew","01100111","⣪"},
[104]={"eqqs","01101000","⠎"},
[105]={"eqqe","01101001","⢎"},
[106]={"eqqq","01101010","⡎"},
[107]={"eqqw","01101011","⣎"},
[108]={"eqws","01101100","⠮"},
[109]={"eqwe","01101101","⢮"},
[110]={"eqwq","01101110","⡮"},
[111]={"eqww","01101111","⣮"},
[112]={"ewss","01110000","⠚"},
[113]={"ewse","01110001","⢚"},
[114]={"ewsq","01110010","⡚"},
[115]={"ewsw","01110011","⣚"},
[116]={"ewes","01110100","⠺"},
[117]={"ewee","01110101","⢺"},
[118]={"eweq","01110110","⡺"},
[119]={"ewew","01110111","⣺"},
[120]={"ewqs","01111000","⠞"},
[121]={"ewqe","01111001","⢞"},
[122]={"ewqq","01111010","⡞"},
[123]={"ewqw","01111011","⣞"},
[124]={"ewws","01111100","⠾"},
[125]={"ewwe","01111101","⢾"},
[126]={"ewwq","01111110","⡾"},
[127]={"ewww","01111111","⣾"},
[128]={"qsss","10000000","⠁"},
[129]={"qsse","10000001","⢁"},
[130]={"qssq","10000010","⡁"},
[131]={"qssw","10000011","⣁"},
[132]={"qses","10000100","⠡"},
[133]={"qsee","10000101","⢡"},
[134]={"qseq","10000110","⡡"},
[135]={"qsew","10000111","⣡"},
[136]={"qsqs","10001000","⠅"},
[137]={"qsqe","10001001","⢅"},
[138]={"qsqq","10001010","⡅"},
[139]={"qsqw","10001011","⣅"},
[140]={"qsws","10001100","⠥"},
[141]={"qswe","10001101","⢥"},
[142]={"qswq","10001110","⡥"},
[143]={"qsww","10001111","⣥"},
[144]={"qess","10010000","⠑"},
[145]={"qese","10010001","⢑"},
[146]={"qesq","10010010","⡑"},
[147]={"qesw","10010011","⣑"},
[148]={"qees","10010100","⠱"},
[149]={"qeee","10010101","⢱"},
[150]={"qeeq","10010110","⡱"},
[151]={"qeew","10010111","⣱"},
[152]={"qeqs","10011000","⠕"},
[153]={"qeqe","10011001","⢕"},
[154]={"qeqq","10011010","⡕"},
[155]={"qeqw","10011011","⣕"},
[156]={"qews","10011100","⠵"},
[157]={"qewe","10011101","⢵"},
[158]={"qewq","10011110","⡵"},
[159]={"qeww","10011111","⣵"},
[160]={"qqss","10100000","⠃"},
[161]={"qqse","10100001","⢃"},
[162]={"qqsq","10100010","⡃"},
[163]={"qqsw","10100011","⣃"},
[164]={"qqes","10100100","⠣"},
[165]={"qqee","10100101","⢣"},
[166]={"qqeq","10100110","⡣"},
[167]={"qqew","10100111","⣣"},
[168]={"qqqs","10101000","⠇"},
[169]={"qqqe","10101001","⢇"},
[170]={"qqqq","10101010","⡇"},
[171]={"qqqw","10101011","⣇"},
[172]={"qqws","10101100","⠧"},
[173]={"qqwe","10101101","⢧"},
[174]={"qqwq","10101110","⡧"},
[175]={"qqww","10101111","⣧"},
[176]={"qwss","10110000","⠓"},
[177]={"qwse","10110001","⢓"},
[178]={"qwsq","10110010","⡓"},
[179]={"qwsw","10110011","⣓"},
[180]={"qwes","10110100","⠳"},
[181]={"qwee","10110101","⢳"},
[182]={"qweq","10110110","⡳"},
[183]={"qwew","10110111","⣳"},
[184]={"qwqs","10111000","⠗"},
[185]={"qwqe","10111001","⢗"},
[186]={"qwqq","10111010","⡗"},
[187]={"qwqw","10111011","⣗"},
[188]={"qwws","10111100","⠷"},
[189]={"qwwe","10111101","⢷"},
[190]={"qwwq","10111110","⡷"},
[191]={"qwww","10111111","⣷"},
[192]={"wsss","11000000","⠉"},
[193]={"wsse","11000001","⢉"},
[194]={"wssq","11000010","⡉"},
[195]={"wssw","11000011","⣉"},
[196]={"wses","11000100","⠩"},
[197]={"wsee","11000101","⢩"},
[198]={"wseq","11000110","⡩"},
[199]={"wsew","11000111","⣩"},
[200]={"wsqs","11001000","⠍"},
[201]={"wsqe","11001001","⢍"},
[202]={"wsqq","11001010","⡍"},
[203]={"wsqw","11001011","⣍"},
[204]={"wsws","11001100","⠭"},
[205]={"wswe","11001101","⢭"},
[206]={"wswq","11001110","⡭"},
[207]={"wsww","11001111","⣭"},
[208]={"wess","11010000","⠙"},
[209]={"wese","11010001","⢙"},
[210]={"wesq","11010010","⡙"},
[211]={"wesw","11010011","⣙"},
[212]={"wees","11010100","⠹"},
[213]={"weee","11010101","⢹"},
[214]={"weeq","11010110","⡹"},
[215]={"weew","11010111","⣹"},
[216]={"weqs","11011000","⠝"},
[217]={"weqe","11011001","⢝"},
[218]={"weqq","11011010","⡝"},
[219]={"weqw","11011011","⣝"},
[220]={"wews","11011100","⠽"},
[221]={"wewe","11011101","⢽"},
[222]={"wewq","11011110","⡽"},
[223]={"weww","11011111","⣽"},
[224]={"wqss","11100000","⠋"},
[225]={"wqse","11100001","⢋"},
[226]={"wqsq","11100010","⡋"},
[227]={"wqsw","11100011","⣋"},
[228]={"wqes","11100100","⠫"},
[229]={"wqee","11100101","⢫"},
[230]={"wqeq","11100110","⡫"},
[231]={"wqew","11100111","⣫"},
[232]={"wqqs","11101000","⠏"},
[233]={"wqqe","11101001","⢏"},
[234]={"wqqq","11101010","⡏"},
[235]={"wqqw","11101011","⣏"},
[236]={"wqws","11101100","⠯"},
[237]={"wqwe","11101101","⢯"},
[238]={"wqwq","11101110","⡯"},
[239]={"wqww","11101111","⣯"},
[240]={"wwss","11110000","⠛"},
[241]={"wwse","11110001","⢛"},
[242]={"wwsq","11110010","⡛"},
[243]={"wwsw","11110011","⣛"},
[244]={"wwes","11110100","⠻"},
[245]={"wwee","11110101","⢻"},
[246]={"wweq","11110110","⡻"},
[247]={"wwew","11110111","⣻"},
[248]={"wwqs","11111000","⠟"},
[249]={"wwqe","11111001","⢟"},
[250]={"wwqq","11111010","⡟"},
[251]={"wwqw","11111011","⣟"},
[252]={"wwws","11111100","⠿"},
[253]={"wwwe","11111101","⢿"},
[254]={"wwwq","11111110","⡿"},
[255]={"wwww","11111111","⣿"},
}
------------

ime.register_command("mw", "YichenLu_Braille", "盲文","none","形11000000|简wsss|号#192")
